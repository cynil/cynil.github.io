<!doctype html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Resume</title>
	
	<link rel="stylesheet" type="text/css" href="main.css">
	<script src="utils.js"></script>
</head>
<body>
	<div id="loading">
		<h2 class="pulse">WAIT A MINUTE <span class="focus-me">:-)</span></h2>
	</div>
	<script type="text/javascript">
		window.addEventListener('load', function(){
			var then = Date.now();
			U.ajax('main.html', {
				success: function(xhr){
					var elapsed = Date.now() - then;
					document.body.innerHTML += xhr.responseText;
					if(elapsed < 500){
						//如果很快就加载好了，那么应该多等一会儿，保证一致性
						//不然的话，loading页面会一闪而过。
						console.log(elapsed);
						U.$('#loading').className = 'fadeout-slowly';				
					}else{
						U.$('#loading').className = 'fadeout';						
					}
					
					U.$('#loading').addEventListener('animationend', function(e){
						document.body.removeChild(this);
					});

					U.loadScript('main.js');
				},
				fail: function(status){
					console.log('here');
					U.$('#loading h2').innerHTML = '<span class="focus-me">' + status + '</span>' + ' AN ERROR OCCURED :-(';
					//style.animation不能获取和设置动画
					U.$('#loading h2').className = '';
				}
			});
		});
	</script>
</body>
</html>





